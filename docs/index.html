<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>JS Lottery</title>
        <style>
            html,
            body {
              margin: 0;
              padding: 0;
            }

            body {
              display: -webkit-flex;
              display: -moz-flex;
              display: -ms-flex;
              display: -o-flex;
              display: flex;

              width: 100%;

              flex-direction: column;

              font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;
              letter-spacing: 0;
              font-weight: 400;
              font-style: normal;
              text-rendering: optimizeLegibility;
              -webkit-font-smoothing: antialiased;
            }
            
            .box_group {

              display: -webkit-flex;
              display: -moz-flex;
              display: -ms-flex;
              display: -o-flex;
              display: flex;
              flex-wrap: wrap;
              margin: auto;
              margin-top: 50px;
              width: 100%;
            }

            .boxs {
              position: relative;
              flex: 0 0 33.33%;
              height: auto;
              -webkit-background-size: cover;
              background-size: cover;
            }

            .boxs.addcover:before {
              position: absolute;
              content: '';
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              background-color: rgba(0, 0, 0, .5);
            }

            .boxs.a {
              background-color: #ffdde5;
              background-image: url(http://www.gratisography.com/pictures/361_1.jpg);
            }
            .boxs.b {
              background-color: #ddbbbb;
              background-image: url(http://www.gratisography.com/pictures/360_1.jpg);
            }
            .boxs.c {
              background-color: #ffddff;
              background-image: url(http://www.gratisography.com/pictures/338_1.jpg);
            }
            .boxs.d {
              background-color: #cce5ee;
              background-image: url(http://www.gratisography.com/pictures/342_1.jpg);
            }
            .boxs.e {
              background-color: #bbd4dd;
              background-image: url(http://www.gratisography.com/pictures/347_1.jpg);
            }
            .boxs.f {
              background-color: #bbddbb;
              background-image: url(http://www.gratisography.com/pictures/350_1.jpg);
            }
            .boxs.g {
              background-color: #eee5cc;
              background-image: url(http://www.gratisography.com/pictures/357_1.jpg);
            }
            .boxs.h {
              background-color: #bcd4d0;
              background-image: url(http://www.gratisography.com/pictures/340_1.jpg);
            }
            .boxs.i {
              background-color: #999999;
              background-image: url(http://www.gratisography.com/pictures/332_1.jpg);
            }

            .start, 
            .cancel {
              margin: auto;
              margin-top: 20px;
              width: 150px;
              height: 45px;
              line-height: 45px;
              text-align: center;
              font-size: 14px;
              border-radius: 3px;
              cursor: pointer;
            }

            .start {
              background-color: #333333;
              color: #ffffff;
            }
            
            .cancel {
              border: 1px solid #333333;
              color: #333333;
            }

        </style>
    </head>
    <body>
      <div class="box_group">
        <div class="boxs addcover a"></div>
        <div class="boxs addcover b"></div>
        <div class="boxs addcover c"></div>
        <div class="boxs addcover d"></div>
        <div class="boxs addcover e"></div>
        <div class="boxs addcover f"></div>
        <div class="boxs addcover g"></div>
        <div class="boxs addcover h"></div>
        <div class="boxs addcover i"></div>
      </div>
      <div class="start">Start</div>
      <div class="cancel">Cancel</div>
    </body>
    <script>
        var _boxs = document.querySelectorAll('.boxs');
        var _num = 0;
        var _stop = false;

        function getTime(s){
          var c = 400,
              d = 50;

          // return c - d  * s * 0.8;
          return s * 150 * 0.8;
        }

        function shuffle_b(arr) {
            var i,
                j,
                temp;
            for (i = arr.length - 1; i > 0; i--) {
                j = Math.floor(Math.random() * (i + 1));
                temp = arr[i];
                arr[i] = arr[j];
                arr[j] = temp;
            }
            return arr;
        };

        function resetAllStatus() {
          _boxs.forEach(function(e, i){
            if (!e.classList.contains('addcover')) {
              e.classList.add('addcover'); 
            }
          });  
        }
        

        function display(){
          if (_stop === true) return;
          shuffle_b([].slice.call(_boxs)).forEach(function(e, i){

            setTimeout(function(){

              _num++;
              
              if (_num > 8) {
                _num = 0;

                display();

              } else {

                resetAllStatus();
                e.classList.remove('addcover');  
                
              }
              
            }, getTime(i) );
            
          })
        }

        function resizeItem(){
          _boxs.forEach(function(e, i){
            e.style.height = e.clientWidth + 'px';
          })
        }

        document.querySelector('.start').addEventListener('click', function(){
          _stop = false;
          display();
        });

        document.querySelector('.cancel').addEventListener('click', function(){
          _stop = true;
        });

        window.addEventListener('resize', function(event){
          _boxs.forEach(function(e, i){
            e.style.height = e.clientWidth + 'px';
          })
        });
        
        resizeItem();
    </script>
</html>